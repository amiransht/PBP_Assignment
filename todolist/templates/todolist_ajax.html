{% extends 'base.html' %}
{% block content %}

<head>
    <title>TODO LIST</title>
    <!--INCLUDING BOOTSTRAP-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    
</head>
<style>

    body {
        font-family: 'Roboto', sans-serif;
        font-weight: 900rem;
        background-color: #f4f7f6;
    }
    .header {
        padding: 10px;
        padding-left: 20px;
        text-align: center;
    }
    .primary-heading {
        font-size: 3rem;
        font-family: 'Roboto', sans-serif ;
        font-weight: bold;
        color: #202121;
        margin-bottom: 8px;
        margin-top: 8px;
    }
    .separator {
      background-color: #202120;
    }
    .body {
        padding-top: 16px;
        padding: 16px;
    }
    
    .footer {
        margin-top: 32px;
    }
    button {
        border-radius: 30px;
        border: black;
        background-color: #fdfdfc ;
        border: 1px solid #202121;
        padding: 5px 10px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
    }
    button:hover{
        background-color:#eaecef ;
    }
    a, a:hover {
        color: #202121;
        font-size: 13px;
        text-decoration-line: none;
    }
    
    .card-header {
      background-color: #fdfdfc;
      padding-top: 2px;
      padding-bottom: 2px;
      vertical-align: middle;
      align-content: center;
      align-items: middle
      
    }
    .card-body {
      background-color: #fdfdfc;
      padding-left: 36px;
      padding-bottom: 5px;
    }
    
    .card:hover {
        transform: scale(1.01);
        box-shadow: 0 10px 20px rgba(0,0,0,.12), 0 4px 8px rgba(0,0,0,.06);
      }
    p {
        margin-top: 10px;
        font-size: large;
        color: #202121;
        margin-bottom: 10px;
        font-weight: bold;
    
    }
    
    h1, h3, h4 {
      font-size: xx-large;
      color: #202120;
      margin-bottom: 8px;
      margin-top: 8px;
    
    }
    
    h3 {
      font-size: large;
      font-weight: normal;
    }
    
    h4 {
      font-size: small;
      text-align: right;
      font-weight: normal;
    }
    
    #desc {
      position: relative;
    }
    #done {
      font-size: small;
      font-weight:bold;
      color: #1d382a;
      
    }
    
    .badge-success {
      background-color: #9fd3d6 ;
    }
    
    #inprogress {
      font-size: small;
      font-weight: bold;
      color: #5c1615;
     
    }
    
    .badge-warning {
      background-color: #fdecc8 ;
    }
    .navbar-light .navbar-nav .nav-link {
      color: #000;
    }
 </style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<!-- <script>
    const modal = document.querySelector('.modal');
    const showModal = document.querySelector('.show-modal');
    const closeModal = document.querySelector('.close-modal');
    const header = document.querySelector('.header');
  
    showModal.addEventListener(
      'click',
      function () {
        var $body = $(document.body);
        var oldWidth = $body.innerWidth();
        $body.css("overflow", "hidden");
        $body.width(oldWidth);
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
        modal.classList.remove('hidden');
        header.classList.add('hidden');
      })
  
    closeModal.addEventListener(
      'click',
      function () {
        var $body = $(document.body);
        $body.css("overflow", "auto");
        $body.width("auto");
        modal.classList.add('hidden');
        header.classList.remove('hidden');
      })
  
    function toggleTodo(id) {
      $.post({
        url: `update/${id}/`,
        type: 'post',
        data: {},
        success: loadTodos
      })
    }
  
    function deleteTodo(id) {
      $.post({
        url: `delete/${id}/`,
        type: 'post',
        data: {},
        success: loadTodos
      })
    }
  
    function createTask() {
      $.post({
        url: `add/`,
        type: 'post',
        data: {
          'title': $('#title-controller').val(),
          'description': $('#descirption-controller').val()
        },
        success: loadTodos
      })
      closeModal.addEventListener(
        'click',
        function () {
          modal.classList.add('hidden');
        })
    }
    $(`#save-task`).attr('onclick', `createTask()`);
  
    function loadTodos() {
      $.get(
        './json',
        function (data) {
          $('#todos-container').empty();
          for (let i = 0; i < data.length; i++) {
            $('#todos-container').append(
              `<div
              class="flex flex-wrap flex-col p-4 md:p-2 lg:p-8 overflow-hidden  bg-white rounded-lg border border-gray-200 shadow-md dark:bg-gray-800 dark:border-gray-700 ">
              <div class="flex-wrap justify-start items-start">
                <h5 class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white">${data[i].fields.title}</h5>
                <p class="mb-3 font-normal text-gray-700 dark:text-gray-400">${data[i].fields.date}</p>
                <p id="todo-mark-${i}" class="mb-3 font-normal"></p>
                <p class="mb-3 text-justify font-normal text-gray-700 dark:text-gray-400">${data[i].fields.description}</p>
              </div>
              <div class="flex flex-wrap mt-auto gap-21">
                <button type="button" onclick="" id="toggle-button-${i}"
                  class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center mr-3 md:mr-0 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                  Toggle
                </button>
                <button type="button" onclick="" id="delete-button-${i}"
                  class="text-white ml-2 bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center mr-3 md:mr-0 dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800">
                  Delete
                </button>
              </div>
            </div>`
            )
            if (data[i].fields.is_finished) {
              $(`#todo-mark-${i}`).addClass('text-green-500').text('Done');
            } else {
              $(`#todo-mark-${i}`).addClass('text-red-600').text('In Progress');
            }
            $(`#toggle-button-${i}`).attr('onclick', `toggleTodo(${data[i].pk})`);
            $(`#delete-button-${i}`).attr('onclick', `deleteTodo(${data[i].pk})`)
          }
        })
    }
  
    loadTodos();
  </script> -->

  <body>
    <div style="align-items: center;"class="wrapper" id="header">
        <!-- HEADER -->
        <div class="header pl-8">
            <div class="d-flex">
              <div class="mr-auto mb-auto mt-auto">
                <h1 class="primary-heading">My Todo</h1>
              </div>
              <div class="p-3">
                <p>{{ username }}</p></div>
              </div>
            </div>
        </div>

        <div class="separator" style="padding:1px ;" ></div>

        <!-- BODY -->
        <div class="body">
            <button  type="button" data-toggle="modal" data-target="#modalCreateTask">Create Task</button>

            <!-- Modal: modalCart -->
            <div class="modal fade" id="modalCreateTask" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                <!--Header-->
                <div class="modal-header">
                    <h4 class="modal-title" id="myModalLabel">Create Task</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">Ã—</span>
                    </button>
                </div>
                <!--Body-->
                <div class="modal-body">
                    <form method="POST" action=""
                        class="w-full mx-40 rounded p-8 bg-white border border-gray-200 shadow-md dark:bg-gray-800 dark:border-gray-700">
                        {% csrf_token %}
                        <!--Title-->
                        <input id="title-controller" type="text" name="title" placeholder="Title" required
                            class="form-control p-8 bg-gray-50 border  text-gray-900 text-sm rounded-lg focus:ring-red-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                        <!--Description-->
                        <input id="description-controller" type="text" name="description" placeholder="Description" required
                            class="form-control p-8 bg-gray-50 border text-gray-900 text-sm rounded-lg focus:ring-red-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                    </form>
                </div>
                <!--Footer-->
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-primary" data-dismiss="modal">Close</button>
                    <button class="btn btn-primary">Save</button>
                </div>
                </div>
            </div>
            </div>
            <!-- Modal: modalCart -->
            <div class="flex items-stretch bg-gray-900 min-h-screen">
                <div class="mx-10 mt-4 md:mx-20 lg:mx-40 w-screenrounded-lg p-4">
                  <div id="todos-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                  </div>
                </div>
            </div>
            <!-- {% for todo in todos %}
            <div class="card" style="margin-bottom: 20px;" >
                {% if todo.is_finished %}
                <div class="card-header align-middle mb-auto mt-auto">
                    <div class="d-flex align-middle pb-2 pt-2">
                        <div class="mr-auto p-0 mb-auto mt-auto"><span class="badge badge-pill badge-success" id="done">Done</span></div>
                        <div class="p-1">
                        <h4>Created On: {{ todo.date }}</h4>
                        </div>
                    </div>
                </div>
                {% else %}
                <div class="card-header align-middle pl-4 mb-auto mt-auto ">
                    <div class="d-flex align-middle pb-2 pt-2">
                    <div class="mr-auto mb-auto mt-auto p-0"><span class="badge badge-pill badge-warning" id="inprogress">In Progress</span></div>
                    <div class="p-1">
                        <h4>Created On: {{ todo.date }}</h4>
                    </div>
                    </div>
                </div>
                {% endif %}
                <div class="card-body d-flex p-4 pr-2 pl-4" id="card-body">
                    <div class="mr-auto justify-content-between" id="desc">
                    <h1>{{ todo.title }}</h1> <span>{{ todo.description }}</span>
                    </div>
                    <div class="mt-auto align-items-end">
                    <button><a href="{% url 'todolist:update' todo.pk %}", class="custom-update-button">Update</a></button>
                    <button><a href="{% url 'todolist:delete' todo.pk %}", class="custom-delete-button">Delete</a></button>
                    </div>
        
                </div>
            </div>
            {% endfor %} -->

            <div class="footer" style="padding-top: 70px;">
                <p style="font-size: medium;">last accessed on {{ last_login }}</p>
                <button style="background-color: #8c1c13;"><a style="color: #f4f7f6;"href="{% url 'todolist:logout' %}", class="custom-alert-button">Logout</a></button>
            </div>
        </div>

    </div>
  </body>
  
  {% endblock content %}